{% extends "layout.html" %}

{% block title %}
    Register
{% endblock %}

{% block main %}
<style>
    body {
        background-image: url('http://127.0.0.1:5000/static/password.jpg');
        background-repeat: no-repeat;
        background-size: cover;
        background-attachment: fixed;
    }
    .alert {
        max-width: 400px;
        margin: 20px auto;
    }
    .card {
        background-color: rgba(0, 0, 0, 0.7);
    }
    .password-container {
        position: relative;
    }
    .toggle-password {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #6c757d;
    }
    .toggle-password:hover {
        color: #495057;
    }
</style>

<div class="container" style="max-width: 500px; margin-top: 50px;">
    <div class="card text-white">
        <div class="card-body">
            <center><h3 class="card-title">Register</h3></center>
            <hr>
            
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'danger' if category == 'error' else category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
            
            <form action="/register" method="post">
                <div class="form-group">
                    <input autocomplete="off" autofocus class="form-control" name="username" 
                           placeholder="Username (4-20 characters)" type="text" required>
                </div>
                
                <div class="form-group password-container">
                    <input class="form-control" name="password" id="password"
                           placeholder="Password (min 8 characters)" type="password" required>
                    <i class="fas fa-eye toggle-password" onclick="togglePassword('password')"></i>
                </div>
                <small class="text-muted">Must contain uppercase, lowercase, special keys and number</small>

                <div class="form-group password-container">
                    <input class="form-control" name="confirm" id="confirmPassword"
                           placeholder="Confirm Password" type="password" required>
                    <i class="fas fa-eye toggle-password" onclick="togglePassword('confirmPassword')"></i>
                </div>
                
                <div class="form-group">
                    <label>Date of Birth:</label>
                    <input class="form-control" name="dob" type="date" required>
                    <small class="text-muted"></small>
                </div>
                <button class="btn btn-primary btn-block" type="submit">Sign Up</button>
            </form>
            
            <div class="text-center mt-3">
                <a href="/login" class="text-white">Already have an account? Login here</a>
            </div>
        </div>
    </div>
</div>

<script>
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const icon = field.nextElementSibling;
        
        if (field.type === "password") {
            field.type = "text";
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
        } else {
            field.type = "password";
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
        }
    }
</script>

{% endblock %}